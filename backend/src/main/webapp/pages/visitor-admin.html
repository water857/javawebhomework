<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>访客记录管理</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div class="container py-4">
    <h1 class="mb-4">访客记录管理</h1>
    <button class="btn btn-primary mb-3" onclick="loadRecords()">刷新记录</button>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>ID</th>
            <th>访客姓名</th>
            <th>电话</th>
            <th>到访时间</th>
            <th>住户ID</th>
        </tr>
        </thead>
        <tbody id="recordTable"></tbody>
    </table>
</div>
<script>
const token = localStorage.getItem('token');
function authHeader() {
  return token ? { 'Authorization': `Bearer ${token}` } : {};
}

async function loadRecords() {
  const resp = await fetch('/backend/api/visitor/list', { headers: authHeader() });
  const data = await resp.json();
  const table = document.getElementById('recordTable');
  table.innerHTML = '';
  (data.data || []).forEach(record => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${record.id}</td>
      <td>${record.visitorName}</td>
      <td>${record.phone || ''}</td>
      <td>${record.visitTime}</td>
      <td>${record.hostUserId}</td>
    `;
    table.appendChild(row);
  });
}

loadRecords();
</script>
</body>
</html>
