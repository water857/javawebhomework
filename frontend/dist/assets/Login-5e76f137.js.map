{"version":3,"file":"Login-5e76f137.js","sources":["../../src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h1>智能社区服务平台</h1>\n    <div class=\"nav-buttons\">\n      <button class=\"btn btn-primary\">登录</button>\n      <router-link to=\"/register\" class=\"btn btn-secondary\">注册</router-link>\n    </div>\n    \n    <!-- 登录表单 -->\n    <div class=\"form-container\">\n      <h2>用户登录</h2>\n      <form @submit.prevent=\"handleLogin\">\n        <div class=\"form-group\">\n          <label for=\"username\">用户名</label>\n          <input type=\"text\" id=\"username\" v-model=\"loginForm.username\" placeholder=\"请输入用户名\" required>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"password\">密码</label>\n          <input type=\"password\" id=\"password\" v-model=\"loginForm.password\" placeholder=\"请输入密码\" required>\n        </div>\n        <button type=\"submit\" class=\"btn btn-primary\" style=\"width: 100%; margin-bottom: 1rem;\">登录</button>\n        <div v-if=\"message\" :class=\"['message', messageType]\">{{ message }}</div>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { apiRequest } from '../services/api.js'\n\nexport default {\n  name: 'Login',\n  data() {\n    return {\n      loginForm: {\n        username: '',\n        password: ''\n      },\n      message: '',\n      messageType: ''\n    }\n  },\n  methods: {\n    async handleLogin() {\n      try {\n        // 发送登录请求\n        const data = await apiRequest('/login', 'POST', this.loginForm)\n        \n        // 保存token和userId到本地存储\n        localStorage.setItem('token', data.data.token)\n        localStorage.setItem('username', data.data.user.username)\n        localStorage.setItem('role', data.data.user.role)\n        localStorage.setItem('userId', data.data.user.id)\n        \n        this.message = '登录成功！欢迎回来，' + data.data.user.username + '！'\n        this.messageType = 'success'\n        \n        // 获取完整用户资料\n        const userData = await apiRequest('/user')\n        // 保存完整用户资料到本地存储\n        localStorage.setItem('userData', JSON.stringify(userData.data))\n        \n        // 根据角色跳转到不同页面\n        setTimeout(() => {\n          if (data.data.user.role === 'resident') {\n            this.$router.push('/resident')\n          } else if (data.data.user.role === 'property_admin') {\n            this.$router.push('/admin')\n          } else if (data.data.user.role === 'service_provider') {\n            this.$router.push('/provider')\n          }\n        }, 1500)\n      } catch (error) {\n        this.message = '登录失败：' + error.message\n        this.messageType = 'error'\n      }\n    }\n  }\n}\n</script>"],"names":["_sfc_main","data","apiRequest","userData","error","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_openBlock","_createElementBlock","_cache","_createElementVNode","_createVNode","_component_router_link","$options","args","$event","$data","_vModelText"],"mappings":"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"}