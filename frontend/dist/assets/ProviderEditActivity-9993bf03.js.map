{"version":3,"file":"ProviderEditActivity-9993bf03.js","sources":["../../src/views/ProviderEditActivity.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <header>\n      <h1>编辑活动</h1>\n      <button class=\"btn\" @click=\"handleBack\">返回活动列表</button>\n    </header>\n\n    <div class=\"publish-form\">\n      <form @submit.prevent=\"handleUpdate\">\n        <div class=\"form-group\">\n          <label for=\"title\">活动标题 <span class=\"required\">*</span></label>\n          <input type=\"text\" id=\"title\" v-model=\"activity.title\" required placeholder=\"请输入活动标题\">\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"content\">活动内容 <span class=\"required\">*</span></label>\n          <textarea id=\"content\" v-model=\"activity.content\" required placeholder=\"请输入活动详细内容\" rows=\"6\"></textarea>\n        </div>\n\n        <div class=\"form-row\">\n          <div class=\"form-group\">\n            <label for=\"startTime\">开始时间 <span class=\"required\">*</span></label>\n            <input type=\"datetime-local\" id=\"startTime\" v-model=\"activity.startTime\" required>\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"endTime\">结束时间 <span class=\"required\">*</span></label>\n            <input type=\"datetime-local\" id=\"endTime\" v-model=\"activity.endTime\" required>\n          </div>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"location\">活动地点 <span class=\"required\">*</span></label>\n          <input type=\"text\" id=\"location\" v-model=\"activity.location\" required placeholder=\"请输入活动地点\">\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"maxParticipants\">最大参与人数</label>\n          <input type=\"number\" id=\"maxParticipants\" v-model.number=\"activity.maxParticipants\" min=\"0\" placeholder=\"0表示无限制\">\n        </div>\n\n        <div class=\"form-actions\">\n          <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"submitting\">保存修改</button>\n          <button type=\"button\" class=\"btn\" @click=\"handleBack\">取消</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { activityApi } from '../services/api';\n\nexport default {\n  name: 'ProviderEditActivity',\n  data() {\n    return {\n      activity: {\n        id: '',\n        title: '',\n        content: '',\n        startTime: '',\n        endTime: '',\n        location: '',\n        maxParticipants: 0\n      },\n      submitting: false,\n      loading: true\n    }\n  },\n  mounted() {\n    this.loadActivityData()\n  },\n  methods: {\n    async loadActivityData() {\n      const activityId = this.$route.params.id\n      try {\n        const response = await activityApi.getActivityDetail(activityId)\n        if (response.code === 'success') {\n          const data = response.data.activity ? response.data.activity : response.data\n          // 验证当前用户是否为活动发布者\n          const currentUserId = localStorage.getItem('userId')\n          if (data.userId != currentUserId) {\n            alert('您无权编辑此活动')\n            this.$router.push('/provider/activities')\n            return\n          }\n          // 转换时间格式为datetime-local所需的格式\n          this.activity = {\n            ...data,\n            startTime: new Date(data.startTime).toISOString().slice(0, 16),\n            endTime: new Date(data.endTime).toISOString().slice(0, 16)\n          }\n        } else {\n          alert(`获取活动详情失败：${response.message}`)\n          this.$router.push('/provider/activities')\n        }\n      } catch (error) {\n        console.error('获取活动详情失败:', error)\n        alert('获取活动详情失败，请稍后重试')\n        this.$router.push('/provider/activities')\n      } finally {\n        this.loading = false\n      }\n    },\n    async handleUpdate() {\n      // 表单验证\n      if (!this.activity.title || !this.activity.content || !this.activity.startTime || !this.activity.endTime || !this.activity.location) {\n        alert('请填写所有必填字段')\n        return\n      }\n\n      // 验证时间逻辑\n      const startTime = new Date(this.activity.startTime)\n      const endTime = new Date(this.activity.endTime)\n      const now = new Date()\n\n      if (startTime < now) {\n        alert('开始时间不能早于当前时间')\n        return\n      }\n\n      if (endTime <= startTime) {\n        alert('结束时间必须晚于开始时间')\n        return\n      }\n\n      this.submitting = true\n      try {\n        // 格式化日期时间为完整的ISO 8601格式（包含秒和毫秒）\n        const activityData = {\n          ...this.activity,\n          startTime: new Date(this.activity.startTime).toISOString(),\n          endTime: new Date(this.activity.endTime).toISOString()\n        };\n        \n        const response = await activityApi.updateActivity(this.activity.id, activityData)\n        if (response.code === 'success') {\n          alert('活动更新成功！')\n          this.$router.push('/provider/activities')\n        } else {\n          alert(`活动更新失败：${response.message}`)\n        }\n      } catch (error) {\n        console.error('活动更新失败:', error)\n        alert('活动更新失败，请稍后重试')\n      } finally {\n        this.submitting = false\n      }\n    },\n    handleBack() {\n      this.$router.push('/provider/activities')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\nheader {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.publish-form {\n  background-color: #fff;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 20px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-row {\n  display: flex;\n  gap: 20px;\n  margin-bottom: 20px;\n}\n\n.form-row .form-group {\n  flex: 1;\n  margin-bottom: 0;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n  color: #333;\n}\n\n.required {\n  color: #ff4d4f;\n}\n\ninput[type=\"text\"],\ninput[type=\"number\"],\ninput[type=\"datetime-local\"],\ntextarea {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n  box-sizing: border-box;\n}\n\ntextarea {\n  resize: vertical;\n  min-height: 100px;\n}\n\ninput:focus,\ntextarea:focus {\n  outline: none;\n  border-color: #1890ff;\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 10px;\n  margin-top: 30px;\n}\n\n.form-actions .btn {\n  padding: 8px 20px;\n}\n\n.form-actions .btn-primary:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n</style>"],"names":["_sfc_main","activityId","response","activityApi","data","currentUserId","error","startTime","endTime","activityData","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_openBlock","_createElementBlock","_createElementVNode","_cache","$options","args","$event","$data","_vModelText","_hoisted_11"],"mappings":"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"}