import{b as d}from"./api-5fa05d82.js";import{_ as c,o as u,c as i,a as n,t as o,n as r,f as m,e as h,h as f}from"./index-1ef266be.js";const p={name:"AdminAnnouncementDetail",data(){return{announcement:null,loading:!1,selectedStatus:""}},mounted(){this.fetchAnnouncementDetail()},methods:{async fetchAnnouncementDetail(){this.loading=!0;try{const t=this.$route.params.id,e=await d.getAnnouncementDetail(t);e.code==="success"?(this.announcement=e.data,this.selectedStatus=this.announcement.status):(console.error("获取公告详情失败:",e.message),alert("获取公告详情失败"))}catch(t){console.error("获取公告详情失败:",t),alert("获取公告详情失败，请稍后重试")}finally{this.loading=!1}},async handleUpdateStatus(){try{const t=await d.updateAnnouncementStatus(this.announcement.id,this.selectedStatus);t.code==="success"?(alert("公告状态更新成功！"),this.fetchAnnouncementDetail()):alert(`公告状态更新失败：${t.message}`)}catch(t){console.error("公告状态更新失败:",t),alert("公告状态更新失败，请稍后重试")}},async handleDeleteAnnouncement(){if(confirm("确定要删除这条公告吗？"))try{const t=await d.deleteAnnouncement(this.announcement.id);t.code==="success"?(alert("公告删除成功"),this.handleBack()):(console.error("删除公告失败:",t.message),alert("删除公告失败"))}catch(t){console.error("删除公告失败:",t),alert("删除公告失败，请稍后重试")}},handleEditAnnouncement(){this.$router.push(`/admin/announcements/edit/${this.announcement.id}`)},handleBack(){this.$router.push("/admin/announcements")},formatDateTime(t){return t?new Date(t).toLocaleString("zh-CN"):""},getStatusText(t){return t===1?"已发布":"草稿"},getStatusClass(t){return t===1?"published":"draft"}}},b={class:"container"},A={key:0,class:"loading"},v={key:1,class:"no-data"},_={key:2,class:"announcement-detail"},D={class:"announcement-header"},S={class:"announcement-info"},g={class:"info-item"},y={class:"info-item"},k={class:"info-item"},C={key:0,class:"info-item"},B={class:"announcement-content"},x={class:"announcement-actions"},w={class:"status-update-section"},T=["disabled"],E={class:"action-buttons"};function N(t,e,U,V,s,a){return u(),i("div",b,[n("header",null,[e[5]||(e[5]=n("h1",null,"公告详情",-1)),n("button",{class:"btn",onClick:e[0]||(e[0]=(...l)=>a.handleBack&&a.handleBack(...l))},"返回公告列表")]),s.loading?(u(),i("div",A,"加载中...")):s.announcement?(u(),i("div",_,[n("div",D,[n("h2",null,o(s.announcement.title),1),n("span",{class:r(["announcement-status",a.getStatusClass(s.announcement.status)])},o(a.getStatusText(s.announcement.status)),3)]),n("div",S,[n("div",g,[e[6]||(e[6]=n("label",null,"发布者:",-1)),n("span",null,o(s.announcement.authorName||"匿名"),1)]),n("div",y,[e[7]||(e[7]=n("label",null,"发布时间:",-1)),n("span",null,o(a.formatDateTime(s.announcement.publishedAt||s.announcement.createdAt)),1)]),n("div",k,[e[8]||(e[8]=n("label",null,"创建时间:",-1)),n("span",null,o(a.formatDateTime(s.announcement.createdAt)),1)]),s.announcement.updatedAt?(u(),i("div",C,[e[9]||(e[9]=n("label",null,"更新时间:",-1)),n("span",null,o(a.formatDateTime(s.announcement.updatedAt)),1)])):m("",!0)]),n("div",B,[e[10]||(e[10]=n("h3",null,"公告内容",-1)),n("p",null,o(s.announcement.content),1)]),n("div",x,[e[13]||(e[13]=n("h3",null,"公告管理",-1)),n("div",w,[e[12]||(e[12]=n("label",null,"更新公告状态:",-1)),h(n("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.selectedStatus=l),class:"status-select"},[...e[11]||(e[11]=[n("option",{value:0},"草稿",-1),n("option",{value:1},"已发布",-1)])],512),[[f,s.selectedStatus,void 0,{number:!0}]]),n("button",{class:"btn btn-primary",onClick:e[2]||(e[2]=(...l)=>a.handleUpdateStatus&&a.handleUpdateStatus(...l)),disabled:s.selectedStatus==s.announcement.status},"更新状态",8,T)]),n("div",E,[n("button",{class:"btn btn-edit",onClick:e[3]||(e[3]=(...l)=>a.handleEditAnnouncement&&a.handleEditAnnouncement(...l))},"编辑公告"),n("button",{class:"btn btn-delete",onClick:e[4]||(e[4]=(...l)=>a.handleDeleteAnnouncement&&a.handleDeleteAnnouncement(...l))},"删除公告")])])])):(u(),i("div",v,"公告不存在"))])}const L=c(p,[["render",N],["__scopeId","data-v-de0d35db"]]);export{L as default};
//# sourceMappingURL=AdminAnnouncementDetail-bda2350f.js.map
