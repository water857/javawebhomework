import{c as h}from"./api-5fa05d82.js";import{_ as v,o,c as r,a as e,e as c,v as g,h as p,l as f,F as m,i as _,t as l,f as d,n as b,d as A}from"./index-1ef266be.js";const P={name:"AdminActivities",data(){return{activities:[],loading:!1,searchQuery:"",statusFilter:"",currentPage:1,pageSize:10,totalPages:1,currentUserId:localStorage.getItem("userId"),userRole:localStorage.getItem("role")}},mounted(){this.fetchActivities()},methods:{async fetchActivities(){this.loading=!0;try{const n=await h.getActivities(this.currentPage,this.pageSize,this.searchQuery,this.statusFilter);n.code==="success"?(this.activities=n.data,this.totalPages=n.totalPages||1):console.error("获取活动列表失败:",n.message)}catch(n){console.error("获取活动列表失败:",n),alert("获取活动列表失败，请稍后重试")}finally{this.loading=!1}},handleActivityDetail(n){this.$router.push(`/admin/activities/${n}`)},handlePublishActivity(){this.$router.push("/admin/activities/publish")},handleBack(){this.$router.push("/admin")},handleEditActivity(n){this.$router.push(`/admin/activities/edit/${n}`)},formatDateTime(n){return n?new Date(n).toLocaleString("zh-CN"):""},getStatusText(n){return{pending:"待开始",ongoing:"进行中",completed:"已完成",cancelled:"已取消"}[n]||n}}},k={class:"container"},y={class:"header-actions"},C={class:"activities-section"},S={class:"filter-section"},x={class:"activities-list"},D={key:0,class:"loading"},I={key:1,class:"no-data"},T=["onClick"],B={class:"activity-date"},F={class:"activity-location"},M={class:"activity-info"},N={key:0,class:"activity-actions"},V=["onClick"],w={key:0,class:"pagination"},z=["disabled"],Q=["disabled"];function U(n,s,E,L,i,a){return o(),r("div",k,[e("header",null,[s[7]||(s[7]=e("h1",null,"活动管理",-1)),e("div",y,[e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=(...t)=>a.handlePublishActivity&&a.handlePublishActivity(...t))},"发布活动"),e("button",{class:"btn",onClick:s[1]||(s[1]=(...t)=>a.handleBack&&a.handleBack(...t))},"返回首页")])]),e("div",C,[e("div",S,[c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>i.searchQuery=t),placeholder:"搜索活动",class:"search-input"},null,512),[[g,i.searchQuery]]),c(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>i.statusFilter=t),class:"filter-select"},[...s[8]||(s[8]=[f('<option value="" data-v-5e86f75f>全部状态</option><option value="pending" data-v-5e86f75f>待开始</option><option value="ongoing" data-v-5e86f75f>进行中</option><option value="completed" data-v-5e86f75f>已完成</option><option value="cancelled" data-v-5e86f75f>已取消</option>',5)])],512),[[p,i.statusFilter]]),e("button",{class:"btn",onClick:s[4]||(s[4]=(...t)=>a.fetchActivities&&a.fetchActivities(...t))},"筛选")]),e("div",x,[i.loading?(o(),r("div",D,"加载中...")):i.activities.length===0?(o(),r("div",I,"暂无活动")):(o(!0),r(m,{key:2},_(i.activities,t=>(o(),r("div",{class:"activity-card",key:t.id},[e("div",{onClick:u=>a.handleActivityDetail(t.id)},[e("h3",null,l(t.title),1),e("p",B,l(a.formatDateTime(t.startTime))+" - "+l(a.formatDateTime(t.endTime)),1),e("p",F,l(t.location),1),e("p",{class:b(["activity-status",t.status])},l(a.getStatusText(t.status)),3),e("div",M,[e("span",null,"发布者: "+l(t.publisherName||"匿名"),1),e("span",null,"参与人数: "+l(t.currentParticipants)+"/"+l(t.maxParticipants||"无限制"),1)])],8,T),t.userId==i.currentUserId?(o(),r("div",N,[e("button",{class:"btn btn-edit",onClick:A(u=>a.handleEditActivity(t.id),["stop"])},"编辑",8,V)])):d("",!0)]))),128))]),i.totalPages>1?(o(),r("div",w,[e("button",{class:"btn",onClick:s[5]||(s[5]=t=>i.currentPage>1&&(i.currentPage--,a.fetchActivities())),disabled:i.currentPage===1},"上一页",8,z),e("span",null,l(i.currentPage)+"/"+l(i.totalPages),1),e("button",{class:"btn",onClick:s[6]||(s[6]=t=>i.currentPage<i.totalPages&&(i.currentPage++,a.fetchActivities())),disabled:i.currentPage===i.totalPages},"下一页",8,Q)])):d("",!0)])])}const q=v(P,[["render",U],["__scopeId","data-v-5e86f75f"]]);export{q as default};
//# sourceMappingURL=AdminActivities-9fd79324.js.map
