import{b as u}from"./api-5fa05d82.js";import{_ as m,o as i,c as r,a as n,d as p,g as l,e as d,v as c,h as f}from"./index-1ef266be.js";const h={name:"AdminEditAnnouncement",data(){return{announcement:{id:null,title:"",content:"",status:1},loading:!0,submitting:!1}},mounted(){this.fetchAnnouncementDetail()},methods:{async fetchAnnouncementDetail(){this.loading=!0;try{const s=this.$route.params.id,e=await u.getAnnouncementDetail(s);e.code==="success"?this.announcement=e.data:(console.error("获取公告详情失败:",e.message),alert("获取公告详情失败"))}catch(s){console.error("获取公告详情失败:",s),alert("获取公告详情失败，请稍后重试")}finally{this.loading=!1}},async handleUpdate(){this.submitting=!0;try{if(!this.announcement.title.trim()||!this.announcement.content.trim()){alert("标题和内容不能为空");return}const s=await u.updateAnnouncement(this.announcement.id,this.announcement);s.code==="success"?(alert("公告更新成功！"),this.$router.push("/admin/announcements")):(console.error("更新公告失败:",s.message),alert(`更新公告失败：${s.message}`))}catch(s){console.error("更新公告失败:",s),alert("更新公告失败，请稍后重试")}finally{this.submitting=!1}},handleBack(){this.$router.push("/admin/announcements")}}},b={class:"container"},v={class:"edit-form"},g={key:0,class:"loading"},_={key:1,class:"error"},y={class:"form-group"},k={class:"form-group"},A={class:"form-group"},x={class:"form-actions"},B=["disabled"];function q(s,e,U,w,o,a){return i(),r("div",b,[n("header",null,[e[6]||(e[6]=n("h1",null,"编辑公告",-1)),n("button",{class:"btn",onClick:e[0]||(e[0]=(...t)=>a.handleBack&&a.handleBack(...t))},"返回公告列表")]),n("div",v,[o.loading?(i(),r("div",g,"加载中...")):o.announcement.id?(i(),r("form",{key:2,onSubmit:e[5]||(e[5]=p((...t)=>a.handleUpdate&&a.handleUpdate(...t),["prevent"]))},[n("div",y,[e[7]||(e[7]=n("label",{for:"title"},[l("公告标题 "),n("span",{class:"required"},"*")],-1)),d(n("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=t=>o.announcement.title=t),required:"",placeholder:"请输入公告标题"},null,512),[[c,o.announcement.title]])]),n("div",k,[e[8]||(e[8]=n("label",{for:"content"},[l("公告内容 "),n("span",{class:"required"},"*")],-1)),d(n("textarea",{id:"content","onUpdate:modelValue":e[2]||(e[2]=t=>o.announcement.content=t),required:"",placeholder:"请输入公告详细内容",rows:"10"},null,512),[[c,o.announcement.content]])]),n("div",A,[e[10]||(e[10]=n("label",{for:"status"},[l("公告状态 "),n("span",{class:"required"},"*")],-1)),d(n("select",{id:"status","onUpdate:modelValue":e[3]||(e[3]=t=>o.announcement.status=t),required:""},[...e[9]||(e[9]=[n("option",{value:"1"},"已发布",-1),n("option",{value:"0"},"草稿",-1)])],512),[[f,o.announcement.status,void 0,{number:!0}]])]),n("div",x,[n("button",{type:"submit",class:"btn btn-primary",disabled:o.submitting},"更新公告",8,B),n("button",{type:"button",class:"btn",onClick:e[4]||(e[4]=(...t)=>a.handleBack&&a.handleBack(...t))},"取消")])],32)):(i(),r("div",_,"公告不存在或已被删除"))])])}const E=m(h,[["render",q],["__scopeId","data-v-c40a553a"]]);export{E as default};
//# sourceMappingURL=AdminEditAnnouncement-7aa41932.js.map
