{"version":3,"file":"ResidentActivities-d5def9a9.js","sources":["../../src/views/ResidentActivities.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <header>\n      <h1>社区活动</h1>\n      <div class=\"header-actions\">\n        <button class=\"btn btn-primary\" @click=\"handlePublishActivity\">发布活动</button>\n        <button class=\"btn\" @click=\"handleBack\">返回首页</button>\n      </div>\n    </header>\n\n    <div class=\"activities-section\">\n      <div class=\"filter-section\">\n        <input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索活动\" class=\"search-input\">\n        <select v-model=\"statusFilter\" class=\"filter-select\">\n          <option value=\"\">全部状态</option>\n          <option value=\"pending\">待开始</option>\n          <option value=\"ongoing\">进行中</option>\n          <option value=\"completed\">已完成</option>\n          <option value=\"cancelled\">已取消</option>\n        </select>\n        <div class=\"checkbox-filter\">\n          <input type=\"checkbox\" id=\"myActivities\" v-model=\"isMyActivities\">\n          <label for=\"myActivities\">只看我发布的活动</label>\n        </div>\n        <button class=\"btn\" @click=\"fetchActivities\">筛选</button>\n      </div>\n\n      <div class=\"activities-list\">\n        <div v-if=\"loading\" class=\"loading\">加载中...</div>\n        <div v-else-if=\"activities.length === 0\" class=\"no-data\">暂无活动</div>\n        <div v-else class=\"activity-card\" v-for=\"activity in activities\" :key=\"activity.id\">\n          <div class=\"activity-content\" @click=\"handleActivityDetail(activity.id)\">\n            <h3>{{ activity.title }}</h3>\n            <p class=\"activity-date\">{{ formatDateTime(activity.startTime) }} - {{ formatDateTime(activity.endTime) }}</p>\n            <p class=\"activity-location\">{{ activity.location }}</p>\n            <p class=\"activity-status\" :class=\"activity.status\">{{ getStatusText(activity.status) }}</p>\n            <div class=\"activity-info\">\n              <span>发布者: {{ activity.publisherName || '匿名' }}</span>\n              <span>参与人数: {{ activity.currentParticipants }}/{{ activity.maxParticipants || '无限制' }}</span>\n            </div>\n          </div>\n          <div class=\"activity-actions\" v-if=\"activity.userId == currentUserId\">\n            <button class=\"btn btn-edit\" @click.stop=\"handleEditActivity(activity.id)\">编辑</button>\n            <button class=\"btn btn-delete\" @click.stop=\"handleDeleteActivity(activity.id)\">删除</button>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"pagination\" v-if=\"totalPages > 1\">\n        <button class=\"btn\" @click=\"handlePrevPage\" :disabled=\"currentPage === 1\">上一页</button>\n        <span>{{ currentPage }}/{{ totalPages }}</span>\n        <button class=\"btn\" @click=\"handleNextPage\" :disabled=\"currentPage === totalPages\">下一页</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { activityApi } from '../services/api';\n\nexport default {\n  name: 'ResidentActivities',\n  data() {\n    return {\n      activities: [],\n      loading: false,\n      searchQuery: '',\n      statusFilter: '',\n      currentPage: 1,\n      pageSize: 10,\n      totalPages: 1,\n      isMyActivities: false\n    }\n  },\n  computed: {\n    currentUserId() {\n      if (typeof localStorage !== 'undefined') {\n        return localStorage.getItem('userId')\n      }\n      return ''\n    }\n  },\n  mounted() {\n    this.fetchActivities()\n  },\n  methods: {\n    async fetchActivities() {\n      this.loading = true\n      try {\n        let response;\n        if (this.isMyActivities) {\n          const userId = this.currentUserId;\n          if (!userId) {\n            alert('无法获取用户信息，请重新登录');\n            this.loading = false;\n            return;\n          }\n          response = await activityApi.getUserActivities(userId, this.currentPage, this.pageSize, this.searchQuery, this.statusFilter);\n        } else {\n          response = await activityApi.getActivities(this.currentPage, this.pageSize, this.searchQuery, this.statusFilter);\n        }\n        if (response.code === 'success') {\n          this.activities = response.data;\n          // 假设API返回的totalPages字段表示总页数\n          this.totalPages = response.totalPages || 1;\n        } else {\n          console.error('获取活动列表失败:', response.message);\n        }\n      } catch (error) {\n        console.error('获取活动列表失败:', error);\n        alert('获取活动列表失败，请稍后重试');\n      } finally {\n        this.loading = false;\n      }\n    },\n    formatDateTime(dateTime) {\n      const date = new Date(dateTime)\n      return date.toLocaleString('zh-CN')\n    },\n    getStatusText(status) {\n      const statusMap = {\n        pending: '待开始',\n        ongoing: '进行中',\n        completed: '已完成',\n        cancelled: '已取消'\n      }\n      return statusMap[status] || status\n    },\n    handleActivityDetail(activityId) {\n      this.$router.push(`/resident/activities/${activityId}`)\n    },\n    handlePublishActivity() {\n      this.$router.push('/resident/activities/publish')\n    },\n    handleBack() {\n      this.$router.push('/resident')\n    },\n    handlePrevPage() {\n      if (this.currentPage > 1) {\n        this.currentPage--\n        this.fetchActivities()\n      }\n    },\n    handleNextPage() {\n      if (this.currentPage < this.totalPages) {\n        this.currentPage++\n        this.fetchActivities()\n      }\n    },\n    handleEditActivity(activityId) {\n      this.$router.push(`/resident/activities/edit/${activityId}`)\n    },\n    handleDeleteActivity(activityId) {\n      if (confirm('确定要删除这个活动吗？')) {\n        activityApi.deleteActivity(activityId)\n          .then(response => {\n            if (response.code === 'success') {\n              alert('活动删除成功')\n              this.fetchActivities()\n            } else {\n              alert(`删除失败: ${response.message}`)\n            }\n          })\n          .catch(error => {\n            console.error('删除活动失败:', error)\n            alert('删除活动失败，请稍后重试')\n          })\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\nheader {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.header-actions .btn {\n  margin-left: 10px;\n}\n\n.filter-section {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 20px;\n  padding: 15px;\n  background-color: #f5f5f5;\n  border-radius: 5px;\n  align-items: center;\n}\n\n.checkbox-filter {\n  display: flex;\n  align-items: center;\n  gap: 5px;\n}\n\n.search-input, .filter-select {\n  padding: 8px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.search-input {\n  width: 300px;\n}\n\n.activities-list {\n  margin-bottom: 20px;\n}\n\n.loading, .no-data {\n  text-align: center;\n  padding: 20px;\n  color: #666;\n}\n\n.activity-card {\n  background-color: #fff;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  margin-bottom: 15px;\n  transition: all 0.3s ease;\n  overflow: hidden;\n}\n\n.activity-card:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transform: translateY(-2px);\n}\n\n.activity-content {\n  padding: 15px;\n  cursor: pointer;\n}\n\n.activity-actions {\n  display: flex;\n  gap: 10px;\n  padding: 10px 15px;\n  border-top: 1px solid #eee;\n  background-color: #fafafa;\n}\n\n.btn-edit {\n  background-color: #1890ff;\n  color: white;\n}\n\n.btn-delete {\n  background-color: #ff4d4f;\n  color: white;\n}\n\n.activity-card h3 {\n  margin: 0 0 10px 0;\n  color: #333;\n}\n\n.activity-date, .activity-location {\n  margin: 5px 0;\n  color: #666;\n  font-size: 14px;\n}\n\n.activity-status {\n  display: inline-block;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: bold;\n  margin: 5px 0;\n}\n\n.activity-status.pending {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n.activity-status.ongoing {\n  background-color: #f6ffed;\n  color: #52c41a;\n}\n\n.activity-status.completed {\n  background-color: #fff7e6;\n  color: #fa8c16;\n}\n\n.activity-status.cancelled {\n  background-color: #fff2f0;\n  color: #ff4d4f;\n}\n\n.activity-info {\n  display: flex;\n  justify-content: space-between;\n  font-size: 12px;\n  color: #999;\n  margin-top: 10px;\n}\n\n.pagination {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 10px;\n}\n\n.pagination button {\n  padding: 5px 10px;\n}\n\n.pagination button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n</style>"],"names":["_sfc_main","response","userId","activityApi","error","dateTime","status","activityId","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_10","_hoisted_11","_hoisted_12","_openBlock","_createElementBlock","_createElementVNode","_cache","$options","args","$data","$event","_hoisted_7","_hoisted_8","_Fragment","_renderList","activity","_toDisplayString","_normalizeClass","_hoisted_13","_withModifiers","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18"],"mappings":"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"}