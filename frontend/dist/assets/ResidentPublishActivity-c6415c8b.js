import{c as m}from"./api-5fa05d82.js";import{_ as c,o as p,c as v,a as i,d as y,g as r,e as a,v as l}from"./index-1ef266be.js";const b={name:"ResidentPublishActivity",data(){return{activity:{title:"",content:"",startTime:"",endTime:"",location:"",maxParticipants:0},submitting:!1}},mounted(){const n=new Date,t=n.toISOString().slice(0,16);this.activity.startTime=t;const u=new Date(n.getTime()+2*60*60*1e3).toISOString().slice(0,16);this.activity.endTime=u},methods:{async handlePublish(){if(!this.activity.title||!this.activity.content||!this.activity.startTime||!this.activity.endTime||!this.activity.location){alert("请填写所有必填字段");return}const n=new Date(this.activity.startTime),t=new Date(this.activity.endTime);if(n<new Date){alert("开始时间不能早于当前时间");return}if(t<=n){alert("结束时间必须晚于开始时间");return}this.submitting=!0;try{const d={...this.activity,startTime:new Date(this.activity.startTime).toISOString(),endTime:new Date(this.activity.endTime).toISOString()},s=await m.publishActivity(d);s.code==="success"?(alert("活动发布成功！"),this.$router.push("/resident/activities")):alert(`活动发布失败：${s.message}`)}catch(d){console.error("活动发布失败:",d),alert("活动发布失败，请稍后重试")}finally{this.submitting=!1}},handleBack(){this.$router.push("/resident/activities")}}},f={class:"container"},T={class:"publish-form"},h={class:"form-group"},g={class:"form-group"},w={class:"form-row"},x={class:"form-group"},P={class:"form-group"},q={class:"form-group"},S={class:"form-group"},_={class:"form-actions"},k=["disabled"];function D(n,t,u,d,s,o){return p(),v("div",f,[i("header",null,[t[9]||(t[9]=i("h1",null,"发布活动",-1)),i("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>o.handleBack&&o.handleBack(...e))},"返回活动列表")]),i("div",T,[i("form",{onSubmit:t[8]||(t[8]=y((...e)=>o.handlePublish&&o.handlePublish(...e),["prevent"]))},[i("div",h,[t[10]||(t[10]=i("label",{for:"title"},[r("活动标题 "),i("span",{class:"required"},"*")],-1)),a(i("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>s.activity.title=e),required:"",placeholder:"请输入活动标题"},null,512),[[l,s.activity.title]])]),i("div",g,[t[11]||(t[11]=i("label",{for:"content"},[r("活动内容 "),i("span",{class:"required"},"*")],-1)),a(i("textarea",{id:"content","onUpdate:modelValue":t[2]||(t[2]=e=>s.activity.content=e),required:"",placeholder:"请输入活动详细内容",rows:"6"},null,512),[[l,s.activity.content]])]),i("div",w,[i("div",x,[t[12]||(t[12]=i("label",{for:"startTime"},[r("开始时间 "),i("span",{class:"required"},"*")],-1)),a(i("input",{type:"datetime-local",id:"startTime","onUpdate:modelValue":t[3]||(t[3]=e=>s.activity.startTime=e),required:""},null,512),[[l,s.activity.startTime]])]),i("div",P,[t[13]||(t[13]=i("label",{for:"endTime"},[r("结束时间 "),i("span",{class:"required"},"*")],-1)),a(i("input",{type:"datetime-local",id:"endTime","onUpdate:modelValue":t[4]||(t[4]=e=>s.activity.endTime=e),required:""},null,512),[[l,s.activity.endTime]])])]),i("div",q,[t[14]||(t[14]=i("label",{for:"location"},[r("活动地点 "),i("span",{class:"required"},"*")],-1)),a(i("input",{type:"text",id:"location","onUpdate:modelValue":t[5]||(t[5]=e=>s.activity.location=e),required:"",placeholder:"请输入活动地点"},null,512),[[l,s.activity.location]])]),i("div",S,[t[15]||(t[15]=i("label",{for:"maxParticipants"},"最大参与人数",-1)),a(i("input",{type:"number",id:"maxParticipants","onUpdate:modelValue":t[6]||(t[6]=e=>s.activity.maxParticipants=e),min:"0",placeholder:"0表示无限制"},null,512),[[l,s.activity.maxParticipants,void 0,{number:!0}]])]),i("div",_,[i("button",{type:"submit",class:"btn btn-primary",disabled:s.submitting},"发布活动",8,k),i("button",{type:"button",class:"btn",onClick:t[7]||(t[7]=(...e)=>o.handleBack&&o.handleBack(...e))},"取消")])],32)])])}const U=c(b,[["render",D],["__scopeId","data-v-952b7830"]]);export{U as default};
//# sourceMappingURL=ResidentPublishActivity-c6415c8b.js.map
