import{b as u}from"./api-5fa05d82.js";import{_ as d,o as r,c as a,a as t,e as h,v as m,F as g,i as f,t as c,f as _}from"./index-1ef266be.js";const p={name:"ResidentAnnouncements",data(){return{announcements:[],loading:!1,searchQuery:"",currentPage:1,pageSize:10,totalPages:1}},mounted(){this.fetchAnnouncements()},activated(){this.fetchAnnouncements()},methods:{async fetchAnnouncements(){this.loading=!0;try{const n=await u.getAnnouncements(this.currentPage,this.pageSize,this.searchQuery,1);n.code==="success"?(this.announcements=n.data,this.totalPages=n.totalPages||1):console.error("获取公告列表失败:",n.message)}catch(n){console.error("获取公告列表失败:",n),alert("获取公告列表失败，请稍后重试")}finally{this.loading=!1}},handleAnnouncementDetail(n){const e=this.announcements.find(l=>l.id===n);e&&alert(`公告详情

标题: ${e.title}

内容: ${e.content}

发布者: ${e.authorName}

发布时间: ${this.formatDateTime(e.publishedAt||e.createdAt)}`)},handleBack(){this.$router.push("/resident")},formatDateTime(n){if(!n)return"";if(typeof n=="string")return n;const e=new Date(n);return isNaN(e.getTime())?"":e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},truncateContent(n){return n?n.length>100?n.substring(0,100)+"...":n:""}}},v={class:"container"},y={class:"announcements-section"},b={class:"filter-section"},A={class:"announcements-list"},k={key:0,class:"loading"},P={key:1,class:"no-data"},C=["onClick"],D={class:"announcement-content"},N={class:"announcement-info"},x={key:0,class:"pagination"},B=["disabled"],Q=["disabled"];function S(n,e,l,w,s,i){return r(),a("div",v,[t("header",null,[e[5]||(e[5]=t("h1",null,"社区公告",-1)),t("button",{class:"btn",onClick:e[0]||(e[0]=(...o)=>i.handleBack&&i.handleBack(...o))},"返回首页")]),t("div",y,[t("div",b,[h(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>s.searchQuery=o),placeholder:"搜索公告",class:"search-input"},null,512),[[m,s.searchQuery]]),t("button",{class:"btn",onClick:e[2]||(e[2]=(...o)=>i.fetchAnnouncements&&i.fetchAnnouncements(...o))},"搜索")]),t("div",A,[s.loading?(r(),a("div",k,"加载中...")):s.announcements.length===0?(r(),a("div",P,"暂无公告")):(r(!0),a(g,{key:2},f(s.announcements,o=>(r(),a("div",{class:"announcement-card",key:o.id},[t("div",{onClick:z=>i.handleAnnouncementDetail(o.id)},[t("h3",null,c(o.title),1),t("p",D,c(i.truncateContent(o.content)),1),t("div",N,[t("span",null,"发布者: "+c(o.authorName||"匿名"),1),t("span",null,"发布时间: "+c(i.formatDateTime(o.publishedAt||o.createdAt)),1)])],8,C)]))),128))]),s.totalPages>1?(r(),a("div",x,[t("button",{class:"btn",onClick:e[3]||(e[3]=o=>s.currentPage>1&&(s.currentPage--,i.fetchAnnouncements())),disabled:s.currentPage===1},"上一页",8,B),t("span",null,c(s.currentPage)+"/"+c(s.totalPages),1),t("button",{class:"btn",onClick:e[4]||(e[4]=o=>s.currentPage<s.totalPages&&(s.currentPage++,i.fetchAnnouncements())),disabled:s.currentPage===s.totalPages},"下一页",8,Q)])):_("",!0)])])}const F=d(p,[["render",S],["__scopeId","data-v-8bee8051"]]);export{F as default};
//# sourceMappingURL=ResidentAnnouncements-6bc48c50.js.map
