import{_ as C,p as i,q as h,o as d,c as r,a as t,e as m,h as F,l as R,v as u,F as V,i as H,f as p,t as a,n as P}from"./index-1ef266be.js";import{p as I}from"./api-5fa05d82.js";const B={name:"ResidentPaymentHistory",setup(){const v=i([]),e=i({paymentMethod:"",startDate:"",endDate:"",minAmount:"",maxAmount:""}),o=i(1),n=i(1),y=i(!1),c=i(null),s=async()=>{try{const l=await I.getPaymentHistory(o.value,10,{paymentMethod:e.value.paymentMethod,startDate:e.value.startDate,endDate:e.value.endDate,minAmount:e.value.minAmount||null,maxAmount:e.value.maxAmount||null});v.value=l.data||[]}catch(l){console.error("获取缴费记录失败:",l),alert("获取缴费记录失败，请稍后重试")}},b=l=>l?new Date(l).toLocaleString("zh-CN"):"",g=l=>({wechat:"微信支付",alipay:"支付宝",bank_transfer:"银行转账",auto_deduction:"自动扣费"})[l]||l,_=l=>({pending:"待处理",success:"成功",failed:"失败",refunded:"已退款"})[l]||l,D=()=>{e.value={paymentMethod:"",startDate:"",endDate:"",minAmount:"",maxAmount:""},s()},x=l=>{c.value=l,y.value=!0},M=()=>{o.value>1&&o.value--},k=()=>{o.value<n.value&&o.value++},w=()=>{window.print()},T=()=>{alert("下载功能开发中...")},A=()=>{router.push("/resident")};return h(()=>{s()}),{payments:v,filter:e,currentPage:o,totalPages:n,showDetailModal:y,selectedPayment:c,getPaymentHistory:s,formatDateTime:b,getPaymentMethodText:g,getStatusText:_,resetFilter:D,viewPaymentDetails:x,previousPage:M,nextPage:k,printReceipt:w,downloadReceipt:T,goBack:A}}},S={class:"payment-history-container"},U={class:"header-section"},N={class:"filter-section"},z={class:"filter-item"},L={class:"filter-item"},q={class:"filter-item"},E={class:"filter-item"},j={class:"filter-item"},G={class:"filter-item"},J={class:"history-section"},K={class:"payment-table"},O={class:"amount"},Q={class:"transaction-id"},W=["onClick"],X={key:0,class:"empty-state"},Y={key:0,class:"pagination"},Z=["disabled"],$={class:"page-info"},tt=["disabled"],et={key:1,class:"modal"},nt={class:"modal-content"},st={class:"modal-header"},at={class:"modal-body"},lt={class:"detail-item"},ot={class:"detail-item"},it={class:"detail-item"},dt={class:"detail-item"},rt={class:"detail-amount"},mt={class:"detail-item"},ut={class:"detail-item"},vt={class:"detail-item"},yt={class:"detail-item"},ct={class:"receipt-section"},pt={class:"receipt"},bt={class:"receipt-content"},ft={class:"receipt-item"},Pt={class:"value"},gt={class:"receipt-item"},_t={class:"value"},Dt={class:"receipt-item"},xt={class:"value"},Mt={class:"receipt-item"},kt={class:"value amount"},wt={class:"receipt-actions"},Tt={class:"modal-footer"};function At(v,e,o,n,y,c){return d(),r("div",S,[t("div",U,[t("button",{class:"btn btn-back",onClick:e[0]||(e[0]=(...s)=>n.goBack&&n.goBack(...s))},"返回首页"),e[14]||(e[14]=t("h2",null,"缴费记录",-1))]),t("div",N,[t("div",z,[e[16]||(e[16]=t("label",{for:"payment-method"},"支付方式：",-1)),m(t("select",{id:"payment-method","onUpdate:modelValue":e[1]||(e[1]=s=>n.filter.paymentMethod=s)},[...e[15]||(e[15]=[R('<option value="" data-v-e6a7a9e2>全部</option><option value="wechat" data-v-e6a7a9e2>微信支付</option><option value="alipay" data-v-e6a7a9e2>支付宝</option><option value="bank_transfer" data-v-e6a7a9e2>银行转账</option><option value="auto_deduction" data-v-e6a7a9e2>自动扣费</option>',5)])],512),[[F,n.filter.paymentMethod]])]),t("div",L,[e[17]||(e[17]=t("label",{for:"start-date"},"开始日期：",-1)),m(t("input",{type:"date",id:"start-date","onUpdate:modelValue":e[2]||(e[2]=s=>n.filter.startDate=s)},null,512),[[u,n.filter.startDate]])]),t("div",q,[e[18]||(e[18]=t("label",{for:"end-date"},"结束日期：",-1)),m(t("input",{type:"date",id:"end-date","onUpdate:modelValue":e[3]||(e[3]=s=>n.filter.endDate=s)},null,512),[[u,n.filter.endDate]])]),t("div",E,[e[19]||(e[19]=t("label",{for:"min-amount"},"最小金额：",-1)),m(t("input",{type:"number",id:"min-amount","onUpdate:modelValue":e[4]||(e[4]=s=>n.filter.minAmount=s),step:"0.01",placeholder:"0.00"},null,512),[[u,n.filter.minAmount]])]),t("div",j,[e[20]||(e[20]=t("label",{for:"max-amount"},"最大金额：",-1)),m(t("input",{type:"number",id:"max-amount","onUpdate:modelValue":e[5]||(e[5]=s=>n.filter.maxAmount=s),step:"0.01",placeholder:"99999.99"},null,512),[[u,n.filter.maxAmount]])]),t("div",G,[t("button",{class:"btn btn-primary",onClick:e[6]||(e[6]=(...s)=>n.getPaymentHistory&&n.getPaymentHistory(...s))},"查询"),t("button",{class:"btn btn-secondary",onClick:e[7]||(e[7]=(...s)=>n.resetFilter&&n.resetFilter(...s))},"重置")])]),t("div",J,[t("table",K,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"支付时间"),t("th",null,"支付方式"),t("th",null,"支付金额"),t("th",null,"交易状态"),t("th",null,"交易ID"),t("th",null,"操作")])],-1)),t("tbody",null,[(d(!0),r(V,null,H(n.payments,s=>(d(),r("tr",{key:s.id},[t("td",null,a(n.formatDateTime(s.paymentTime)),1),t("td",null,a(n.getPaymentMethodText(s.paymentMethod)),1),t("td",O,"¥"+a(s.amount.toFixed(2)),1),t("td",null,[t("span",{class:P(["payment-status",s.status])},a(n.getStatusText(s.status)),3)]),t("td",Q,a(s.transactionId),1),t("td",null,[t("button",{class:"btn btn-view",onClick:b=>n.viewPaymentDetails(s)}," 查看详情 ",8,W)])]))),128))])]),n.payments.length===0?(d(),r("div",X,[...e[22]||(e[22]=[t("p",null,"暂无缴费记录",-1)])])):p("",!0)]),n.payments.length>0?(d(),r("div",Y,[t("button",{class:"btn btn-secondary",onClick:e[8]||(e[8]=(...s)=>n.previousPage&&n.previousPage(...s)),disabled:n.currentPage===1}," 上一页 ",8,Z),t("span",$,"第 "+a(n.currentPage)+" 页，共 "+a(n.totalPages)+" 页",1),t("button",{class:"btn btn-secondary",onClick:e[9]||(e[9]=(...s)=>n.nextPage&&n.nextPage(...s)),disabled:n.currentPage===n.totalPages}," 下一页 ",8,tt)])):p("",!0),n.showDetailModal?(d(),r("div",et,[t("div",nt,[t("div",st,[e[23]||(e[23]=t("h3",null,"支付详情",-1)),t("button",{class:"close-btn",onClick:e[10]||(e[10]=s=>n.showDetailModal=!1)},"×")]),t("div",at,[t("div",lt,[e[24]||(e[24]=t("label",null,"交易ID：",-1)),t("span",null,a(n.selectedPayment.transactionId),1)]),t("div",ot,[e[25]||(e[25]=t("label",null,"支付时间：",-1)),t("span",null,a(n.formatDateTime(n.selectedPayment.paymentTime)),1)]),t("div",it,[e[26]||(e[26]=t("label",null,"支付方式：",-1)),t("span",null,a(n.getPaymentMethodText(n.selectedPayment.paymentMethod)),1)]),t("div",dt,[e[27]||(e[27]=t("label",null,"支付金额：",-1)),t("span",rt,"¥"+a(n.selectedPayment.amount.toFixed(2)),1)]),t("div",mt,[e[28]||(e[28]=t("label",null,"交易状态：",-1)),t("span",{class:P(["payment-status",n.selectedPayment.status])},a(n.getStatusText(n.selectedPayment.status)),3)]),t("div",ut,[e[29]||(e[29]=t("label",null,"自动扣费：",-1)),t("span",null,a(n.selectedPayment.autoDeduction?"是":"否"),1)]),t("div",vt,[e[30]||(e[30]=t("label",null,"创建时间：",-1)),t("span",null,a(n.formatDateTime(n.selectedPayment.createdAt)),1)]),t("div",yt,[e[31]||(e[31]=t("label",null,"更新时间：",-1)),t("span",null,a(n.formatDateTime(n.selectedPayment.updatedAt)),1)]),t("div",ct,[e[39]||(e[39]=t("h4",null,"缴费凭证",-1)),t("div",pt,[e[37]||(e[37]=t("div",{class:"receipt-header"},[t("h5",null,"智能社区物业费缴费凭证")],-1)),t("div",bt,[t("div",ft,[e[32]||(e[32]=t("span",{class:"label"},"交易ID：",-1)),t("span",Pt,a(n.selectedPayment.transactionId),1)]),t("div",gt,[e[33]||(e[33]=t("span",{class:"label"},"支付时间：",-1)),t("span",_t,a(n.formatDateTime(n.selectedPayment.paymentTime)),1)]),t("div",Dt,[e[34]||(e[34]=t("span",{class:"label"},"支付方式：",-1)),t("span",xt,a(n.getPaymentMethodText(n.selectedPayment.paymentMethod)),1)]),t("div",Mt,[e[35]||(e[35]=t("span",{class:"label"},"支付金额：",-1)),t("span",kt,"¥"+a(n.selectedPayment.amount.toFixed(2)),1)]),e[36]||(e[36]=t("div",{class:"receipt-item"},[t("span",{class:"label"},"交易状态："),t("span",{class:"value status"},"已支付")],-1))]),e[38]||(e[38]=t("div",{class:"receipt-footer"},[t("p",null,"本凭证仅作为缴费记录凭证，不作为发票使用")],-1))]),t("div",wt,[t("button",{class:"btn btn-primary",onClick:e[11]||(e[11]=(...s)=>n.printReceipt&&n.printReceipt(...s))},"打印凭证"),t("button",{class:"btn btn-secondary",onClick:e[12]||(e[12]=(...s)=>n.downloadReceipt&&n.downloadReceipt(...s))},"下载凭证")])])]),t("div",Tt,[t("button",{class:"btn btn-primary",onClick:e[13]||(e[13]=s=>n.showDetailModal=!1)},"关闭")])])])):p("",!0)])}const Ft=C(B,[["render",At],["__scopeId","data-v-e6a7a9e2"]]);export{Ft as default};
//# sourceMappingURL=ResidentPaymentHistory-0fc3c250.js.map
