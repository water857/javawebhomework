{"version":3,"file":"ProviderActivityDetail-ee0314f9.js","sources":["../../src/views/ProviderActivityDetail.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <header>\n      <h1>活动详情</h1>\n      <button class=\"btn\" @click=\"handleBack\">返回活动列表</button>\n    </header>\n\n    <div class=\"activity-detail\" v-if=\"activity\">\n      <div class=\"activity-header\">\n        <h2>{{ activity.title }}</h2>\n        <p class=\"activity-status\" :class=\"activity.status\">{{ getStatusText(activity.status) }}</p>\n      </div>\n\n      <div class=\"activity-meta\">\n        <div class=\"meta-item\">\n          <span class=\"meta-label\">发布者：</span>\n          <span>{{ activity.publisherName || '匿名' }}</span>\n        </div>\n        <div class=\"meta-item\">\n          <span class=\"meta-label\">时间：</span>\n          <span>{{ formatDateTime(activity.startTime) }} - {{ formatDateTime(activity.endTime) }}</span>\n        </div>\n        <div class=\"meta-item\">\n          <span class=\"meta-label\">地点：</span>\n          <span>{{ activity.location }}</span>\n        </div>\n        <div class=\"meta-item\">\n          <span class=\"meta-label\">参与人数：</span>\n          <span>{{ activity.currentParticipants }}/{{ activity.maxParticipants || '无限制' }}</span>\n        </div>\n      </div>\n\n      <div class=\"activity-content\">\n        <h3>活动内容</h3>\n        <div class=\"content-text\">\n          {{ activity.content }}\n        </div>\n      </div>\n\n      <div class=\"activity-actions\">\n        <button class=\"btn btn-primary\" @click=\"handleRegister\" v-if=\"canRegister\">报名活动</button>\n        <button class=\"btn btn-primary\" @click=\"handleCancelRegistration\" v-if=\"isRegistered\">取消报名</button>\n        <button class=\"btn btn-primary\" @click=\"handleCheckin\" v-if=\"canCheckin\">签到</button>\n        <!-- 只对活动发布者显示编辑和删除按钮 -->\n        <button class=\"btn btn-edit\" @click=\"handleEdit\" v-if=\"activity.publisherId === localStorage.getItem('userId')\">编辑活动</button>\n        <button class=\"btn btn-delete\" @click=\"handleDelete\" v-if=\"activity.publisherId === localStorage.getItem('userId')\">删除活动</button>\n      </div>\n\n      <div class=\"activity-evaluation\" v-if=\"activity.status === 'completed'\">\n        <h3>活动评价</h3>\n        <form @submit.prevent=\"handleEvaluate\">\n          <div class=\"form-group\">\n            <label for=\"evaluation\">评价内容</label>\n            <textarea id=\"evaluation\" v-model=\"evaluation.content\" placeholder=\"请输入您对活动的评价\" rows=\"4\"></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"rating\">评分</label>\n            <select id=\"rating\" v-model.number=\"evaluation.rating\">\n              <option value=\"1\">1星</option>\n              <option value=\"2\">2星</option>\n              <option value=\"3\">3星</option>\n              <option value=\"4\">4星</option>\n              <option value=\"5\">5星</option>\n            </select>\n          </div>\n          <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"submitting\">提交评价</button>\n        </form>\n      </div>\n    </div>\n\n    <div class=\"loading\" v-else-if=\"loading\">加载中...</div>\n    <div class=\"error\" v-else>无法获取活动详情</div>\n  </div>\n</template>\n\n<script>\nimport { activityApi } from '../services/api';\n\nexport default {\n  name: 'ProviderActivityDetail',\n  data() {\n    return {\n      activity: null,\n      loading: true,\n      evaluation: {\n        content: '',\n        rating: 5\n      },\n      submitting: false,\n      isRegistered: false,\n      canRegister: false,\n      canCheckin: false\n    }\n  },\n  mounted() {\n    this.loadActivityDetail()\n  },\n  methods: {\n    async loadActivityDetail() {\n      const activityId = this.$route.params.id\n      try {\n        const response = await activityApi.getActivityDetail(activityId)\n        if (response.code === 'success') {\n          this.activity = response.data\n          this.checkRegistrationStatus()\n        } else {\n          alert(`获取活动详情失败：${response.message}`)\n          this.$router.push('/provider/activities')\n        }\n      } catch (error) {\n        console.error('获取活动详情失败:', error)\n        alert('获取活动详情失败，请稍后重试')\n        this.$router.push('/provider/activities')\n      } finally {\n        this.loading = false\n      }\n    },\n    formatDateTime(dateTime) {\n      const date = new Date(dateTime)\n      return date.toLocaleString('zh-CN')\n    },\n    getStatusText(status) {\n      const statusMap = {\n        pending: '待开始',\n        ongoing: '进行中',\n        completed: '已完成',\n        cancelled: '已取消'\n      }\n      return statusMap[status] || status\n    },\n    checkRegistrationStatus() {\n      // 这里需要根据实际API返回的用户注册状态来判断\n      // 暂时假设用户未注册\n      this.isRegistered = false\n      this.canRegister = this.activity.status === 'pending'\n      this.canCheckin = this.activity.status === 'ongoing'\n    },\n    async handleRegister() {\n      try {\n        const response = await activityApi.registerForActivity(this.activity.id)\n        if (response.code === 'success') {\n          alert('报名成功')\n          this.isRegistered = true\n          this.canRegister = false\n          this.activity.currentParticipants++\n        } else {\n          alert(`报名失败：${response.message}`)\n        }\n      } catch (error) {\n        console.error('报名失败:', error)\n        alert('报名失败，请稍后重试')\n      }\n    },\n    async handleCancelRegistration() {\n      try {\n        const response = await activityApi.cancelRegistration(this.activity.id)\n        if (response.code === 'success') {\n          alert('取消报名成功')\n          this.isRegistered = false\n          this.canRegister = this.activity.status === 'pending'\n          this.activity.currentParticipants--\n        } else {\n          alert(`取消报名失败：${response.message}`)\n        }\n      } catch (error) {\n        console.error('取消报名失败:', error)\n        alert('取消报名失败，请稍后重试')\n      }\n    },\n    async handleCheckin() {\n      try {\n        const response = await activityApi.checkin(this.activity.id)\n        if (response.code === 'success') {\n          alert('签到成功')\n          this.canCheckin = false\n        } else {\n          alert(`签到失败：${response.message}`)\n        }\n      } catch (error) {\n        console.error('签到失败:', error)\n        alert('签到失败，请稍后重试')\n      }\n    },\n    async handleEvaluate() {\n      this.submitting = true\n      try {\n        const response = await activityApi.evaluateActivity(this.activity.id, this.evaluation)\n        if (response.code === 'success') {\n          alert('评价成功')\n          this.evaluation = { content: '', rating: 5 }\n        } else {\n          alert(`评价失败：${response.message}`)\n        }\n      } catch (error) {\n        console.error('评价失败:', error)\n        alert('评价失败，请稍后重试')\n      } finally {\n        this.submitting = false\n      }\n    },\n    handleEdit() {\n      this.$router.push(`/provider/activities/edit/${this.activity.id}`)\n    },\n    async handleDelete() {\n      if (confirm('确定要删除这个活动吗？')) {\n        try {\n          const response = await activityApi.deleteActivity(this.activity.id)\n          if (response.code === 'success') {\n            alert('活动删除成功')\n            this.$router.push('/provider/activities')\n          } else {\n            alert(`删除失败：${response.message}`)\n          }\n        } catch (error) {\n          console.error('删除活动失败:', error)\n          alert('删除活动失败，请稍后重试')\n        }\n      }\n    },\n    handleBack() {\n      this.$router.push('/provider/activities')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\n.activity-detail {\n  background-color: #fff;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 20px;\n  margin-top: 20px;\n}\n\n.activity-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 20px;\n}\n\n.activity-header h2 {\n  margin: 0;\n  color: #333;\n}\n\n.activity-status {\n  display: inline-block;\n  padding: 4px 12px;\n  border-radius: 16px;\n  font-size: 14px;\n  font-weight: bold;\n}\n\n.activity-status.pending {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n.activity-status.ongoing {\n  background-color: #f6ffed;\n  color: #52c41a;\n}\n\n.activity-status.completed {\n  background-color: #fff7e6;\n  color: #fa8c16;\n}\n\n.activity-status.cancelled {\n  background-color: #fff2f0;\n  color: #ff4d4f;\n}\n\n.activity-meta {\n  background-color: #f5f5f5;\n  padding: 15px;\n  border-radius: 6px;\n  margin-bottom: 20px;\n}\n\n.meta-item {\n  display: flex;\n  margin-bottom: 8px;\n}\n\n.meta-item:last-child {\n  margin-bottom: 0;\n}\n\n.meta-label {\n  font-weight: bold;\n  margin-right: 10px;\n  color: #666;\n}\n\n.activity-content {\n  margin-bottom: 20px;\n}\n\n.activity-content h3 {\n  margin: 0 0 15px 0;\n  color: #333;\n}\n\n.content-text {\n  line-height: 1.6;\n  color: #333;\n  white-space: pre-line;\n}\n\n.activity-actions {\n  margin-bottom: 30px;\n}\n\n.activity-actions .btn {\n  margin-right: 10px;\n}\n\n.btn-edit {\n  background-color: #1890ff;\n  color: white;\n}\n\n.btn-delete {\n  background-color: #ff4d4f;\n  color: white;\n}\n\n.activity-evaluation {\n  border-top: 1px solid #eee;\n  padding-top: 20px;\n}\n\n.activity-evaluation h3 {\n  margin: 0 0 15px 0;\n  color: #333;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n  color: #333;\n}\n\ntextarea, select {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n  box-sizing: border-box;\n}\n\ntextarea {\n  resize: vertical;\n  min-height: 100px;\n}\n\n.loading, .error {\n  text-align: center;\n  padding: 50px 0;\n  color: #666;\n}\n</style>"],"names":["_sfc_main","activityId","response","activityApi","error","dateTime","status","_hoisted_1","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","_openBlock","_createElementBlock","_createElementVNode","_cache","$options","args","$data","_hoisted_2","_toDisplayString","_normalizeClass","_ctx","_hoisted_12","$event","_vModelText","_hoisted_15","_hoisted_16","_hoisted_17"],"mappings":"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"}