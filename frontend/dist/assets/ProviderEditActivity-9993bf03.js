import{c as u}from"./api-5fa05d82.js";import{_ as m,o as v,c as p,a as i,d as y,g as c,e as n,v as l}from"./index-1ef266be.js";const f={name:"ProviderEditActivity",data(){return{activity:{id:"",title:"",content:"",startTime:"",endTime:"",location:"",maxParticipants:0},submitting:!1,loading:!0}},mounted(){this.loadActivityData()},methods:{async loadActivityData(){const d=this.$route.params.id;try{const t=await u.getActivityDetail(d);if(t.code==="success"){const r=t.data.activity?t.data.activity:t.data,a=localStorage.getItem("userId");if(r.userId!=a){alert("您无权编辑此活动"),this.$router.push("/provider/activities");return}this.activity={...r,startTime:new Date(r.startTime).toISOString().slice(0,16),endTime:new Date(r.endTime).toISOString().slice(0,16)}}else alert(`获取活动详情失败：${t.message}`),this.$router.push("/provider/activities")}catch(t){console.error("获取活动详情失败:",t),alert("获取活动详情失败，请稍后重试"),this.$router.push("/provider/activities")}finally{this.loading=!1}},async handleUpdate(){if(!this.activity.title||!this.activity.content||!this.activity.startTime||!this.activity.endTime||!this.activity.location){alert("请填写所有必填字段");return}const d=new Date(this.activity.startTime),t=new Date(this.activity.endTime);if(d<new Date){alert("开始时间不能早于当前时间");return}if(t<=d){alert("结束时间必须晚于开始时间");return}this.submitting=!0;try{const a={...this.activity,startTime:new Date(this.activity.startTime).toISOString(),endTime:new Date(this.activity.endTime).toISOString()},s=await u.updateActivity(this.activity.id,a);s.code==="success"?(alert("活动更新成功！"),this.$router.push("/provider/activities")):alert(`活动更新失败：${s.message}`)}catch(a){console.error("活动更新失败:",a),alert("活动更新失败，请稍后重试")}finally{this.submitting=!1}},handleBack(){this.$router.push("/provider/activities")}}},h={class:"container"},T={class:"publish-form"},b={class:"form-group"},g={class:"form-group"},w={class:"form-row"},x={class:"form-group"},D={class:"form-group"},q={class:"form-group"},I={class:"form-group"},S={class:"form-actions"},U=["disabled"];function _(d,t,r,a,s,o){return v(),p("div",h,[i("header",null,[t[9]||(t[9]=i("h1",null,"编辑活动",-1)),i("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>o.handleBack&&o.handleBack(...e))},"返回活动列表")]),i("div",T,[i("form",{onSubmit:t[8]||(t[8]=y((...e)=>o.handleUpdate&&o.handleUpdate(...e),["prevent"]))},[i("div",b,[t[10]||(t[10]=i("label",{for:"title"},[c("活动标题 "),i("span",{class:"required"},"*")],-1)),n(i("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>s.activity.title=e),required:"",placeholder:"请输入活动标题"},null,512),[[l,s.activity.title]])]),i("div",g,[t[11]||(t[11]=i("label",{for:"content"},[c("活动内容 "),i("span",{class:"required"},"*")],-1)),n(i("textarea",{id:"content","onUpdate:modelValue":t[2]||(t[2]=e=>s.activity.content=e),required:"",placeholder:"请输入活动详细内容",rows:"6"},null,512),[[l,s.activity.content]])]),i("div",w,[i("div",x,[t[12]||(t[12]=i("label",{for:"startTime"},[c("开始时间 "),i("span",{class:"required"},"*")],-1)),n(i("input",{type:"datetime-local",id:"startTime","onUpdate:modelValue":t[3]||(t[3]=e=>s.activity.startTime=e),required:""},null,512),[[l,s.activity.startTime]])]),i("div",D,[t[13]||(t[13]=i("label",{for:"endTime"},[c("结束时间 "),i("span",{class:"required"},"*")],-1)),n(i("input",{type:"datetime-local",id:"endTime","onUpdate:modelValue":t[4]||(t[4]=e=>s.activity.endTime=e),required:""},null,512),[[l,s.activity.endTime]])])]),i("div",q,[t[14]||(t[14]=i("label",{for:"location"},[c("活动地点 "),i("span",{class:"required"},"*")],-1)),n(i("input",{type:"text",id:"location","onUpdate:modelValue":t[5]||(t[5]=e=>s.activity.location=e),required:"",placeholder:"请输入活动地点"},null,512),[[l,s.activity.location]])]),i("div",I,[t[15]||(t[15]=i("label",{for:"maxParticipants"},"最大参与人数",-1)),n(i("input",{type:"number",id:"maxParticipants","onUpdate:modelValue":t[6]||(t[6]=e=>s.activity.maxParticipants=e),min:"0",placeholder:"0表示无限制"},null,512),[[l,s.activity.maxParticipants,void 0,{number:!0}]])]),i("div",S,[i("button",{type:"submit",class:"btn btn-primary",disabled:s.submitting},"保存修改",8,U),i("button",{type:"button",class:"btn",onClick:t[7]||(t[7]=(...e)=>o.handleBack&&o.handleBack(...e))},"取消")])],32)])])}const B=m(f,[["render",_],["__scopeId","data-v-2673369c"]]);export{B as default};
//# sourceMappingURL=ProviderEditActivity-9993bf03.js.map
