{"version":3,"file":"ResidentAnnouncements-6bc48c50.js","sources":["../../src/views/ResidentAnnouncements.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <header>\n      <h1>社区公告</h1>\n      <button class=\"btn\" @click=\"handleBack\">返回首页</button>\n    </header>\n\n    <div class=\"announcements-section\">\n      <div class=\"filter-section\">\n        <input type=\"text\" v-model=\"searchQuery\" placeholder=\"搜索公告\" class=\"search-input\">\n        <button class=\"btn\" @click=\"fetchAnnouncements\">搜索</button>\n      </div>\n\n      <div class=\"announcements-list\">\n        <div v-if=\"loading\" class=\"loading\">加载中...</div>\n        <div v-else-if=\"announcements.length === 0\" class=\"no-data\">暂无公告</div>\n        <div v-else class=\"announcement-card\" v-for=\"announcement in announcements\" :key=\"announcement.id\">\n          <div @click=\"handleAnnouncementDetail(announcement.id)\">\n            <h3>{{ announcement.title }}</h3>\n            <p class=\"announcement-content\">{{ truncateContent(announcement.content) }}</p>\n            <div class=\"announcement-info\">\n              <span>发布者: {{ announcement.authorName || '匿名' }}</span>\n              <span>发布时间: {{ formatDateTime(announcement.publishedAt || announcement.createdAt) }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"pagination\" v-if=\"totalPages > 1\">\n        <button class=\"btn\" @click=\"currentPage > 1 && (currentPage--, fetchAnnouncements())\" :disabled=\"currentPage === 1\">上一页</button>\n        <span>{{ currentPage }}/{{ totalPages }}</span>\n        <button class=\"btn\" @click=\"currentPage < totalPages && (currentPage++, fetchAnnouncements())\" :disabled=\"currentPage === totalPages\">下一页</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { announcementApi } from '../services/api';\n\nexport default {\n  name: 'ResidentAnnouncements',\n  data() {\n    return {\n      announcements: [],\n      loading: false,\n      searchQuery: '',\n      currentPage: 1,\n      pageSize: 10,\n      totalPages: 1\n    }\n  },\n  mounted() {\n    this.fetchAnnouncements();\n  },\n  activated() {\n    // 组件激活时自动刷新数据\n    this.fetchAnnouncements();\n  },\n  methods: {\n    async fetchAnnouncements() {\n      this.loading = true;\n      try {\n        // 居民只能查看已发布的公告，所以statusFilter固定为1\n        const response = await announcementApi.getAnnouncements(this.currentPage, this.pageSize, this.searchQuery, 1);\n        if (response.code === 'success') {\n          this.announcements = response.data;\n          this.totalPages = response.totalPages || 1;\n        } else {\n          console.error('获取公告列表失败:', response.message);\n        }\n      } catch (error) {\n        console.error('获取公告列表失败:', error);\n        alert('获取公告列表失败，请稍后重试');\n      } finally {\n        this.loading = false;\n      }\n    },\n    handleAnnouncementDetail(announcementId) {\n      // 居民查看公告详情，这里可以跳转到详情页面，或者直接在当前页面展开详情\n      // 为了简化实现，我们直接在控制台打印公告ID，并弹出一个alert显示公告内容\n      // 实际项目中应该跳转到详情页面\n      const announcement = this.announcements.find(a => a.id === announcementId);\n      if (announcement) {\n        alert(`公告详情\\n\\n标题: ${announcement.title}\\n\\n内容: ${announcement.content}\\n\\n发布者: ${announcement.authorName}\\n\\n发布时间: ${this.formatDateTime(announcement.publishedAt || announcement.createdAt)}`);\n      }\n    },\n    handleBack() {\n      this.$router.push('/resident');\n    },\n    formatDateTime(dateTime) {\n      if (!dateTime) return '';\n      \n      // 如果已经是字符串格式，直接返回（后端已格式化）\n      if (typeof dateTime === 'string') {\n        return dateTime;\n      }\n      \n      // 否则，处理时间戳或日期对象\n      const date = new Date(dateTime);\n      if (isNaN(date.getTime())) {\n        return '';\n      }\n      \n      // 确保格式一致性\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n      });\n    },\n    truncateContent(content) {\n      if (!content) return '';\n      return content.length > 100 ? content.substring(0, 100) + '...' : content;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\nheader {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.header-actions {\n  display: flex;\n  gap: 10px;\n}\n\n.announcements-section {\n  background-color: #fff;\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.filter-section {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 20px;\n  flex-wrap: wrap;\n}\n\n.search-input {\n  padding: 8px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n  width: 250px;\n}\n\n.announcements-list {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.announcement-card {\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 15px;\n  background-color: #fafafa;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.announcement-card:hover {\n  box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.15);\n  transform: translateY(-2px);\n}\n\n.announcement-card h3 {\n  margin: 0 0 8px 0;\n  color: #333;\n}\n\n.announcement-content {\n  margin: 5px 0;\n  color: #666;\n  font-size: 14px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  line-height: 1.5;\n  height: 3em;\n}\n\n.announcement-info {\n  display: flex;\n  gap: 15px;\n  margin-top: 10px;\n  font-size: 14px;\n  color: #888;\n}\n\n.pagination {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-top: 20px;\n  gap: 10px;\n}\n\n.loading, .no-data {\n  text-align: center;\n  padding: 50px 0;\n  color: #666;\n}\n</style>"],"names":["_sfc_main","response","announcementApi","error","announcementId","announcement","a","dateTime","date","content","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_8","_hoisted_9","_openBlock","_createElementBlock","_createElementVNode","_cache","$options","args","$data","$event","_hoisted_5","_hoisted_6","_Fragment","_renderList","_toDisplayString","_hoisted_10","_hoisted_11","_hoisted_12"],"mappings":"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"}